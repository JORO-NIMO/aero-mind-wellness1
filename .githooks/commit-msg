#!/bin/sh
# Git commit-msg hook
# Purpose: adjust commit messages automatically for this repo.
# - Replace occurrences of a target word (case-insensitive)
# - Append a footer line if not already present
#
# Notes:
# - Runs for every commit, including `git commit -m "..."`.
# - Customize TARGET_WORD, REPLACEMENT, and FOOTER to your needs.
# - On Windows, this runs via Git's bundled sh (Git Bash). LF endings recommended.

MSG_FILE="$1"

# --- Configuration ---
TARGET_WORD="lovable"
REPLACEMENT="-"
# ---------------------

# Safety: ensure the file exists
if [ ! -f "$MSG_FILE" ]; then
  exit 0
fi

# Replace target word (case-insensitive). Using character class to avoid sed -I portability quirks.
# This replaces any case variant of 'lovable'. Adjust to your needs.
sed -i.bak -E "s/[Ll][Oo][Vv][Aa][Bb][Ll][Ee]/${REPLACEMENT}/g" "$MSG_FILE" 2>/dev/null || true
rm -f "$MSG_FILE.bak" 2>/dev/null || true

# Append footer if not already present (case-insensitive check for the footer title at line start)
if ! grep -qi "^${FOOTER_TITLE}" "$MSG_FILE"; then
  {
    echo
    echo "$FOOTER_TEXT"
  } >> "$MSG_FILE"
fi

# Ensure trailing newline
printf '\n' >> "$MSG_FILE" 2>/dev/null || true
